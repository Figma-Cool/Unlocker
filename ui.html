<main>
  <button id="unlock">All Unlock</button>
  <ul></ul>
</main>
<footer>
  Made by <a target="_blank" href="https://figma.cool">Figma.Cool</a>
</footer>

<script>
  const ul = document.querySelector("ul");
  const unlockBtn = document.querySelector("#unlock");

  function createList(textContent, id) {
    let li = document.createElement("li");
    li.textContent = textContent;
    li.setAttribute("data-id", id);
    ul.appendChild(li);
  }

  unlockBtn.addEventListener("click", () => {
    parent.postMessage(
      { pluginMessage: { type: "all-unlock", click: "all" } },
      "*"
    );
    ul.innerHTML = "";
    createList("ðŸ”“ All layers Unlocked");
  });

  window.onmessage = async (event) => {
    const message = event.data.pluginMessage;
    if (message.isLockArr) {
      message.isLockArr.forEach((item) => {
        createList(item, item[1]);
      });

      ul.querySelectorAll("li").forEach((item) => {
        item.addEventListener("click", () => {
          parent.postMessage(
            {
              pluginMessage: { type: "lock-item", clickItem: item.dataset.id },
            },
            "*"
          );
        });
      });
    }

    if (message.empty === 0 && message.isLockArr == null) {
      ul.innerHTML = "";
      createList("ðŸ”“ All layers Unlocked");
    }
  };
</script>
<style>
  * {
    margin: 0;
    padding: 0;
  }

  body {
    font-family: -apple-system, sans-serif;
    color: #3d4373;
  }

  a {
    text-decoration: none;
    color: #3d4373;
  }

  a:hover {
    text-decoration: underline;
  }

  input {
    width: 100%;
    height: 48px;
  }

  footer {
    z-index: 999;
    width: calc(100% - 24px);
    padding: 8px 12px;
    position: fixed;
    bottom: 0;
    left: 0;
    background-color: white;
    text-align: right;
    font-size: 12px;
    line-height: 12px;
    color: #8b8eab;
    border-top: 1px solid #e5e5e5;
  }

  iframe {
    width: 600px;
    height: 420px;
  }

  ul {
    width: 100%;
    padding: 24px 0;
  }

  li {
    font-size: 13px;
    line-height: 13px;
    font-weight: 300;
    padding: 8px 12px;
    border-top: 1px solid hsl(240, 20%, 92%);
    transition: all 0.2s ease;
    cursor: default;
  }

  li:last-child {
    border-bottom: 1px solid hsl(240, 20%, 92%);
  }

  li:hover {
    background: #f6f6f9;
  }

  main {
    margin: 40px 0;
  }
</style>
